# 单点登录（SSO）是什么：

单点登录（SSO，Single Sign On），是在企业内部多个应用系统（如考勤系统、财务系统、人事系统等）场景下，用户只需要登录一次，就可以访问多个应用系统。

同理用户只需注销一次，就可以从多个应用系统退出登录。

简单来说就是，一次登录，全部登录！一次注销，全部注销！！

目前主流的SSO技术有JWT、CAS、Oauth2、SAML等

- 认证：验证主体身份的有效性，其中主体不仅单指用户，也会涉及对设备、服务的验证。
- 授权：授予主体对客体的权限信息，主体是活动的，客体是被动的，两者的关系处于流动的状态，取决于不同的业务场景。


## 技术层面原理

### SESSION + COOKIE 模式  
1. 登录，用户拿账号密码到认证中心登录
2. 认证中心生成sission表，记录用户信息（sid），sission表有这个用户的信息就说明用户登陆过
3. 认证中心通过cookie返回给用户sid
4. 用户携带sid去访问子系统（浏览器会自动处理）
5. 子系统携带用户发过来的sid去访问认证中心
6. 认证中心认证通过，发送用户信息给子系统，登陆成功

优点：认证中心对用户具有很强的控制力
缺点：对认证中心压力大，单个子系统访问量大，导致认证中心的访问量也大

### TOKEN 模式（JWT生成token） 
1. 登录，用户拿账号密码到认证中心登录
2. 认证中心生成一个TOKEN返回给用户，用户存起来（cookie，localStorage）（此时返回了用户信息？用户信息是在token里面）
3. 用户去携带token访问子系统
4. 子系统（不去访问认证中心）自行认证（比如子系统与认证中心交换密钥）
5. 认证通过子系统解析token信息返回给用户，登录成功

> 在此过程中为了防止token被伪造，有一种生成token加密的方法JSON Web Token，简称JWT

缺点：失去对用户的控制力度，A系统禁止用户登录了，用户携带token还能去登录B系统，为了弥补对这个缺点，综合出了双TOKEN模式

#### JWT

### 双TOKNE 模式（TOKEN + REFRESHTOKEN）
1. 登录，用户拿账号密码到认证中心登录
2. 认证中心返回2个token，一个短token，一个长token-refreshToken（长短是针对过期时间）

TOKEN 所有子系统都能够认识 过期时间短
REFRESHTOKEN 只有认证中心才认识 过期时间长

3. 携带TOKEN请求子系统，过期之后携带REFRESHTOKEN请求认证中心去换取新的TOKEN

这种方式就是通过TOKEN短的过期时间来使用户来认证中心报道，从而实现加强对用户的控制

4. 子系统（不去访问认证中心）自行认证（比如子系统与认证中心交换密钥）
5. 认证通过子系统解析token信息返回给用户，登录成功

问题：过期时间短重新去换取新的TOKEN-->如何实现token的无感刷新

## OAuth2.0单点登录

## CAS单点登录

## saml


相关链接
- https://blog.csdn.net/wxz258/article/details/125832434
- https://www.cnblogs.com/zyd123123/p/16583126.html
- https://blog.csdn.net/u013905744/article/details/111225420
